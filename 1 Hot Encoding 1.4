import pandas as pd
import os

# Set the 'Python' folder as the default folder
python_folder = os.path.expanduser("~/Desktop/Python")
os.chdir(python_folder)

# Read data from the Excel file
excel_file = 'Regression.xlsx'
df = pd.read_excel(excel_file)

# Create new columns with one-hot encoding for 'Business Process Name' and 'Company'
df_encoded = pd.get_dummies(df, columns=['Business Process Name', 'Company'], 
                             prefix=['Business Process Name 1H', 'Company 1H'])

# Specify the desktop folder and the output file name
output_file = 'Regression_Features.xlsx'

# Export the modified data to the new Excel file
df_encoded.to_excel(output_file, index=False)

print(f"Data has been processed and saved to {output_file}")
